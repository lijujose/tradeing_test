name: try github scripts

on:
  push:
    branches:
      - master

jobs:
  try-github-script:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@0.2.0
        with:
          github-token: ${{github.token}}
          script: |
            const owner = context.payload.sender.login;
            const repo = context.payload.repository.name;
            const {data: pullRequests} = await github.pulls.list({
              owner,
              repo,
              base: "master",
              state: "open"
            });
            console.log(pullRequests);
            for (let pr of pullRequests) {
              const {data: commits} = await github.pulls.listCommits({
                owner,
                repo,
                pull_number: pr.number
              });
              console.log(commits, pr.number);
            }
